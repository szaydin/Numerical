function x = backSubst(U, y, k)

% Backward substitution
% x = backSubst(U, y, k) solves Ux = y by backward substitution method
% implemented using recursion.

% =========================================================================
%                            Backward Substitution
% =========================================================================

% -------------------------------------------------------------------------
% Find the size of matrix U
% -------------------------------------------------------------------------

[m, n] = size(U);

% -------------------------------------------------------------------------
% If first call k = n
% -------------------------------------------------------------------------

if(nargin == 2)
    k = n;
end

% -------------------------------------------------------------------------
% Find y
% -------------------------------------------------------------------------

x = y(k)/U(k,k);

% -------------------------------------------------------------------------
% Apply recursion.
% -------------------------------------------------------------------------

if(k > 1)
    u = [U(1:k-1,k);zeros(m-k+1,1)];
    x = [backSubst(U,y-x*u,k-1);x];
end

end

% =========================================================================