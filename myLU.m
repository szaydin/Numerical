function [L, U] = myLU(A, k, L)

% LU Decomposition.
% [L, U] = myLU(A, k, L) decomposes matrix A into lower triangular
% matrix L and upper triangular matrix U. 

% =========================================================================
%                               LU Decomposition
% =========================================================================

% -------------------------------------------------------------------------
% Find the number of columns in A
% -------------------------------------------------------------------------

n = size(A,2);

% -------------------------------------------------------------------------
% During the first call of the function assign k and L as 1.
% -------------------------------------------------------------------------

if(nargin == 1)
    k = 1;
    L = 1;
end

% -------------------------------------------------------------------------
% Compute elimination matrix for index k.
% -------------------------------------------------------------------------

[M, Minv] = elimMat(A(:,k), k);

% -------------------------------------------------------------------------
% End recursive calls if k = n-1, else call the function recursively.
% -------------------------------------------------------------------------

if(k == n-1)
    U = M * A;
    L = L * Minv;
else
    [L, U] =  myLU(M * A, k+1, L*Minv);
end

   
end

% =========================================================================

