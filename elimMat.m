function [M,L] = elimMat(A,k)

% Compute elimination matrix.
% [M,L] = elimMat(A,k) computes the elimination matrices M,L for the given
% matrix A and index k,

% =========================================================================
%              Function to compute elimination matrix
% =========================================================================

% -------------------------------------------------------------------------
% Initially define M as identity matrix.
% -------------------------------------------------------------------------

M = eye(length(A));

% -------------------------------------------------------------------------
% Adjust the k th column 
% -------------------------------------------------------------------------

M(k+1:end,k) = -A(k+1:end)/A(k);

% -------------------------------------------------------------------------
% Find L
% -------------------------------------------------------------------------

L = inv(M);

end

% =========================================================================